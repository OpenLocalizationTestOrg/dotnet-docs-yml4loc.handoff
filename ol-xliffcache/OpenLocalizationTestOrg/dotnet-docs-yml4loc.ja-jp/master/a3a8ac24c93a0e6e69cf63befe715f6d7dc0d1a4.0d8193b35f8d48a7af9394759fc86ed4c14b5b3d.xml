{"nodes":[{"content":"Used to indicate the expected drop location when an item is dragged to a new position in a <xref href=\"System.Windows.Forms.ListView\"></xref> control. This functionality is available only on Windows XP and later.","nodes":[{"pos":[0,212],"content":"Used to indicate the expected drop location when an item is dragged to a new position in a <xref href=\"System.Windows.Forms.ListView\"></xref> control. This functionality is available only on Windows XP and later.","nodes":[{"content":"Used to indicate the expected drop location when an item is dragged to a new position in a <ph id=\"ph1\">&lt;xref href=\"System.Windows.Forms.ListView\"&gt;&lt;/xref&gt;</ph> control.","pos":[0,150],"source":"Used to indicate the expected drop location when an item is dragged to a new position in a <xref href=\"System.Windows.Forms.ListView\"></xref> control."},{"content":"This functionality is available only on Windows XP and later.","pos":[151,212]}]}],"pos":[731,944],"yaml":true},{"content":"You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.  \n  \n This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=fullName> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically. To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.SortOrder?displayProperty=fullName> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.View?displayProperty=fullName>, <xref:System.Windows.Forms.View?displayProperty=fullName>, or <xref:System.Windows.Forms.View?displayProperty=fullName>. Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.  \n  \n The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event to update the position of the insertion mark as an item is dragged. It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event to insert a dragged item at the correct location.  \n  \n To update the position of the insertion mark, follow these steps:  \n  \n1.  In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=fullName> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.  \n  \n2.  Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.  \n  \n3.  Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.  \n  \n4.  If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.  \n  \n5.  Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method. The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value. If an item is dragged over itself, the index is -1 and the insertion mark is hidden.  \n  \n To insert the dragged item at the correct location, follow these steps:  \n  \n1.  In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark. Store this value to be used later as the insertion index.  \n  \n2.  If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value.  \n  \n3.  Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=fullName> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection at the stored insertion index.  \n  \n4.  Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=fullName> method to remove the original copy of the dragged item.  \n  \n You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection are not altered before the insertion.  \n  \n To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value. For more information, see the Example section.  \n  \n You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property. If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.  \n  \n> [!NOTE]\n>  The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName> method. On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear. As a result, any code that depends on the insertion mark feature may not work correctly. You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable. For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.  \n>   \n>  The insertion mark feature is provided by the same library that provides the operating system themes feature. To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName> value.","nodes":[{"pos":[0,321],"content":"You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.","nodes":[{"content":"You can retrieve a <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark&gt;</ph> from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ListView.InsertionMark%2A&gt;</ph> property of a <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.","pos":[0,321],"source":"You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position."}]},{"pos":[328,1222],"content":"This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=fullName> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically. To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.SortOrder?displayProperty=fullName> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.View?displayProperty=fullName>, <xref:System.Windows.Forms.View?displayProperty=fullName>, or <xref:System.Windows.Forms.View?displayProperty=fullName>. Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.","nodes":[{"content":"This feature works only when the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=fullName&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph> and when the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control does not sort the items automatically.","pos":[0,232],"source":"This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=fullName> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically."},{"content":"To prevent automatic sorting, the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=fullName&gt;</ph> property must be set to <ph id=\"ph2\">&lt;xref:System.Windows.Forms.SortOrder?displayProperty=fullName&gt;</ph> and the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ListView.View%2A?displayProperty=fullName&gt;</ph> property must be set to <ph id=\"ph4\">&lt;xref:System.Windows.Forms.View?displayProperty=fullName&gt;</ph>, <ph id=\"ph5\">&lt;xref:System.Windows.Forms.View?displayProperty=fullName&gt;</ph>, or <ph id=\"ph6\">&lt;xref:System.Windows.Forms.View?displayProperty=fullName&gt;</ph>.","pos":[233,708],"source":" To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.SortOrder?displayProperty=fullName> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.View?displayProperty=fullName>, <xref:System.Windows.Forms.View?displayProperty=fullName>, or <xref:System.Windows.Forms.View?displayProperty=fullName>."},{"content":"Additionally, the insertion mark feature cannot be used with the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> grouping feature because the grouping feature orders the items by group membership.","pos":[709,894],"source":" Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership."}]},{"pos":[1229,1780],"content":"The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event to update the position of the insertion mark as an item is dragged. It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event to insert a dragged item at the correct location.","nodes":[{"content":"The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event to update the position of the insertion mark as an item is dragged. It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event to insert a dragged item at the correct location.","pos":[0,551],"nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark&gt;</ph> class is typically used in a handler for the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName&gt;</ph> or <ph id=\"ph3\">&lt;xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName&gt;</ph> event to update the position of the insertion mark as an item is dragged.","pos":[0,316],"source":"The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event to update the position of the insertion mark as an item is dragged."},{"content":"It is also used in a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName&gt;</ph> event to insert a dragged item at the correct location.","pos":[317,551],"source":" It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event to insert a dragged item at the correct location."}]}]},{"pos":[1787,1852],"content":"To update the position of the insertion mark, follow these steps:","nodes":[{"content":"To update the position of the insertion mark, follow these steps:","pos":[0,65]}]},{"pos":[1862,2266],"content":"In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=fullName> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.","nodes":[{"content":"In a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName&gt;</ph> event, use the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=fullName&gt;</ph> property to access the <ph id=\"ph4\">&lt;xref:System.Windows.Forms.ListViewInsertionMark&gt;</ph> object associated with the <ph id=\"ph5\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control.","pos":[0,404],"source":"In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=fullName> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control."}]},{"pos":[2276,2420],"content":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.","nodes":[{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method to retrieve the index of the item closest to the mouse pointer.","pos":[0,144],"source":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer."}]},{"pos":[2430,2589],"content":"Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.","nodes":[{"content":"Pass the index value to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName&gt;</ph> method to retrieve the bounding rectangle of the item.","pos":[0,159],"source":"Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item."}]},{"pos":[2599,2813],"content":"If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph>; otherwise, set it to <ph id=\"ph3\">`true`</ph>.","source":"If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`."},{"pos":[2823,3297],"content":"Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method. The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value. If an item is dragged over itself, the index is -1 and the insertion mark is hidden.","nodes":[{"content":"Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method. The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value. If an item is dragged over itself, the index is -1 and the insertion mark is hidden.","pos":[0,474],"nodes":[{"content":"Set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Index%2A&gt;</ph> property to the index value retrieved from the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method.","pos":[0,187],"source":"Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method."},{"content":"The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property value.","pos":[188,389],"source":" The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value."},{"content":"If an item is dragged over itself, the index is -1 and the insertion mark is hidden.","pos":[390,474]}]}]},{"pos":[3304,3375],"content":"To insert the dragged item at the correct location, follow these steps:","nodes":[{"content":"To insert the dragged item at the correct location, follow these steps:","pos":[0,71]}]},{"pos":[3385,3745],"content":"In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark. Store this value to be used later as the insertion index.","nodes":[{"content":"In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark. Store this value to be used later as the insertion index.","pos":[0,360],"nodes":[{"content":"In a handler for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName&gt;</ph> or <ph id=\"ph2\">&lt;xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName&gt;</ph> event, use the <ph id=\"ph3\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Index%2A&gt;</ph> property to determine the current location of the insertion mark.","pos":[0,302],"source":"In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark."},{"content":"Store this value to be used later as the insertion index.","pos":[303,360]}]}]},{"pos":[3755,3902],"content":"If the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property is set to <ph id=\"ph2\">`true`</ph>, increment the stored insertion index value.","source":"If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value."},{"pos":[3912,4181],"content":"Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=fullName> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection at the stored insertion index.","nodes":[{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=fullName&gt;</ph> method to insert a clone of the dragged item into the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName&gt;</ph> collection at the stored insertion index.","pos":[0,269],"source":"Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=fullName> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection at the stored insertion index."}]},{"pos":[4191,4349],"content":"Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=fullName> method to remove the original copy of the dragged item.","nodes":[{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=fullName&gt;</ph> method to remove the original copy of the dragged item.","pos":[0,158],"source":"Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=fullName> method to remove the original copy of the dragged item."}]},{"pos":[4356,4582],"content":"You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection are not altered before the insertion.","nodes":[{"content":"You must insert a clone of the dragged item before the original copy is removed so the index values in the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName&gt;</ph> collection are not altered before the insertion.","pos":[0,226],"source":"You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection are not altered before the insertion."}]},{"pos":[4589,4932],"content":"To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value. For more information, see the Example section.","nodes":[{"content":"To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value. For more information, see the Example section.","pos":[0,343],"nodes":[{"content":"To ensure that the items are displayed in the same order as their index values, you must set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName&gt;</ph> property to an implementation of the <ph id=\"ph2\">&lt;xref:System.Collections.IComparer&gt;</ph> interface that sorts items by index value.","pos":[0,296],"source":"To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value."},{"content":"For more information, see the Example section.","pos":[297,343]}]}]},{"pos":[4939,5240],"content":"You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property. If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.","nodes":[{"content":"You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property. If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.","pos":[0,301],"nodes":[{"content":"You can modify the color of the insertion mark by using the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Color%2A&gt;</ph> property.","pos":[0,128],"source":"You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property."},{"content":"If you need the size or position of the insertion mark, you can get its bounding rectangle through the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A&gt;</ph> property.","pos":[129,301],"source":" If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property."}]}]},{"pos":[5248,6015],"content":"[!NOTE]\n The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName> method. On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear. As a result, any code that depends on the insertion mark feature may not work correctly. You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable. For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.","leadings":["","> "],"nodes":[{"content":" The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName> method. On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear. As a result, any code that depends on the insertion mark feature may not work correctly. You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable. For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.","pos":[8,765],"nodes":[{"content":"The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName&gt;</ph> method.","pos":[1,221],"source":" The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName> method."},{"content":"On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear.","pos":[222,347]},{"content":"As a result, any code that depends on the insertion mark feature may not work correctly.","pos":[348,436]},{"content":"You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable.","pos":[437,592]},{"content":"For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.","pos":[593,757]}]}]},{"pos":[6026,6397],"content":"The insertion mark feature is provided by the same library that provides the operating system themes feature. To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName> value.","nodes":[{"content":"The insertion mark feature is provided by the same library that provides the operating system themes feature. To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName> value.","pos":[0,371],"nodes":[{"content":"The insertion mark feature is provided by the same library that provides the operating system themes feature.","pos":[0,109]},{"content":"To check for the availability of this library, call the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName&gt;</ph> method overload and pass in the <ph id=\"ph2\">&lt;xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName&gt;</ph> value.","pos":[110,371],"source":" To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName> value."}]}]}],"pos":[955,7392],"yaml":true,"extradata":"MT"},{"content":"Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property.","nodes":[{"pos":[0,203],"content":"Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <ph id=\"ph1\">&lt;xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"&gt;&lt;/xref&gt;</ph> property.","source":"Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property."}],"pos":[9957,10161],"yaml":true},{"content":"The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.  \n  \n To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:  \n  \n1.  Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.  \n  \n2.  Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.  \n  \n3.  If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.  \n  \n For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.","nodes":[{"pos":[0,248],"content":"The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.","nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.","pos":[0,248],"source":"The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item."}]},{"pos":[255,392],"content":"To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:","nodes":[{"content":"To calculate the value needed for the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property, follow these steps:","pos":[0,137],"source":"To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:"}]},{"pos":[402,546],"content":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.","nodes":[{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method to retrieve the index of the item closest to the mouse pointer.","pos":[0,144],"source":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer."}]},{"pos":[556,715],"content":"Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.","nodes":[{"content":"Pass the index value to the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName&gt;</ph> method to retrieve the bounding rectangle of the item.","pos":[0,159],"source":"Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item."}]},{"pos":[725,939],"content":"If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property to <ph id=\"ph2\">`false`</ph>; otherwise, set it to <ph id=\"ph3\">`true`</ph>.","source":"If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`."},{"pos":[946,1051],"content":"For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.","nodes":[{"content":"For more information, see the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark&gt;</ph> overview reference topic.","pos":[0,105],"source":"For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic."}]}],"pos":[10172,11236],"yaml":true,"extradata":"MT"},{"content":"`true` if the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property; otherwise, `false`. The default is `false`.","nodes":[{"pos":[0,217],"content":"`true` if the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property; otherwise, `false`. The default is `false`.","nodes":[{"content":"<ph id=\"ph1\">`true`</ph> if the insertion mark appears to the right of the item with the index specified by the <ph id=\"ph2\">&lt;xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"&gt;&lt;/xref&gt;</ph> property; otherwise, <ph id=\"ph3\">`false`</ph>.","pos":[0,193],"source":"`true` if the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property; otherwise, `false`."},{"content":"The default is <ph id=\"ph1\">`false`</ph>.","pos":[194,217],"source":" The default is `false`."}]}],"pos":[12622,12842],"yaml":true},{"content":"Gets the bounding rectangle of the insertion mark.","nodes":[{"pos":[0,50],"content":"Gets the bounding rectangle of the insertion mark.","nodes":[{"content":"Gets the bounding rectangle of the insertion mark.","pos":[0,50]}]}],"pos":[13884,13935],"yaml":true},{"content":"The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.","nodes":[{"pos":[0,147],"content":"The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.","nodes":[{"content":"The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control.","pos":[0,147],"source":"The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control."}]}],"pos":[13946,14094],"yaml":true,"extradata":"MT"},{"content":"A <xref href=\"System.Drawing.Rectangle\"></xref> that represents the position and size of the insertion mark.","nodes":[{"pos":[0,108],"content":"A <ph id=\"ph1\">&lt;xref href=\"System.Drawing.Rectangle\"&gt;&lt;/xref&gt;</ph> that represents the position and size of the insertion mark.","source":"A <xref href=\"System.Drawing.Rectangle\"></xref> that represents the position and size of the insertion mark."}],"pos":[14233,14342],"yaml":true},{"content":"Gets or sets the color of the insertion mark.","nodes":[{"pos":[0,45],"content":"Gets or sets the color of the insertion mark.","nodes":[{"content":"Gets or sets the color of the insertion mark.","pos":[0,45]}]}],"pos":[15368,15414],"yaml":true},{"content":"Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.","nodes":[{"pos":[0,145],"content":"Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.","nodes":[{"content":"Use this property to set the insertion mark color to a value other than the foreground color of the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView&gt;</ph> control.","pos":[0,145],"source":"Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control."}]}],"pos":[15425,15571],"yaml":true,"extradata":"MT"},{"content":"A <xref href=\"System.Drawing.Color\"></xref> value that represents the color of the insertion mark. The default value is the value of the <xref href=\"System.Windows.Forms.ListView.ForeColor\"></xref> property.","nodes":[{"pos":[0,207],"content":"A <xref href=\"System.Drawing.Color\"></xref> value that represents the color of the insertion mark. The default value is the value of the <xref href=\"System.Windows.Forms.ListView.ForeColor\"></xref> property.","nodes":[{"content":"A <ph id=\"ph1\">&lt;xref href=\"System.Drawing.Color\"&gt;&lt;/xref&gt;</ph> value that represents the color of the insertion mark.","pos":[0,98],"source":"A <xref href=\"System.Drawing.Color\"></xref> value that represents the color of the insertion mark."},{"content":"The default value is the value of the <ph id=\"ph1\">&lt;xref href=\"System.Windows.Forms.ListView.ForeColor\"&gt;&lt;/xref&gt;</ph> property.","pos":[99,207],"source":" The default value is the value of the <xref href=\"System.Windows.Forms.ListView.ForeColor\"></xref> property."}]}],"pos":[16968,17176],"yaml":true},{"content":"Gets or sets the index of the item next to which the insertion mark appears.","nodes":[{"pos":[0,76],"content":"Gets or sets the index of the item next to which the insertion mark appears.","nodes":[{"content":"Gets or sets the index of the item next to which the insertion mark appears.","pos":[0,76]}]}],"pos":[18201,18278],"yaml":true},{"content":"The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item. The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection. To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.  \n  \n Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.","nodes":[{"pos":[0,596],"content":"The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item. The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection. To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.","nodes":[{"content":"The insertion mark appears to the left of the item with the specified index if the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A&gt;</ph> property is set to <ph id=\"ph2\">`false`</ph>; otherwise, it appears to the right of the item.","pos":[0,228],"source":"The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item."},{"content":"The insertion mark disappears automatically when a dragged item is inserted into the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName&gt;</ph> collection.","pos":[229,396],"source":" The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection."},{"content":"To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Index%2A&gt;</ph> value to -1.","pos":[397,596],"source":" To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1."}]},{"pos":[603,847],"content":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.","nodes":[{"content":"Use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.","pos":[0,244],"source":"Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation."}]}],"pos":[18289,19141],"yaml":true,"extradata":"MT"},{"content":"The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.","nodes":[{"pos":[0,103],"content":"The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.","nodes":[{"content":"The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.","pos":[0,103]}]}],"pos":[20513,20617],"yaml":true},{"content":"Retrieves the index of the item closest to the specified point.","nodes":[{"pos":[0,63],"content":"Retrieves the index of the item closest to the specified point.","nodes":[{"content":"Retrieves the index of the item closest to the specified point.","pos":[0,63]}]}],"pos":[21769,21833],"yaml":true},{"content":"This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation. Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property. When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1. In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.  \n  \n This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns the item at the specified location only, or `null` if there is no item at that location. The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns `null`, for example, when the mouse pointer is located between two items. For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.","nodes":[{"pos":[0,455],"content":"This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation. Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property. When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1. In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.","nodes":[{"content":"This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation. Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property. When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1. In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.","pos":[0,455],"nodes":[{"content":"This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation.","pos":[0,103]},{"content":"Use the index value returned to set the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Index%2A&gt;</ph> property.","pos":[104,212],"source":" Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property."},{"content":"When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1.","pos":[213,321]},{"content":"In this case, setting the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.Index%2A&gt;</ph> property to this value hides the insertion mark.","pos":[322,455],"source":" In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark."}]}]},{"pos":[462,1075],"content":"This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns the item at the specified location only, or `null` if there is no item at that location. The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns `null`, for example, when the mouse pointer is located between two items. For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.","nodes":[{"content":"This method finds the closest item regardless of where the mouse pointer is located, while the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName&gt;</ph> method returns the item at the specified location only, or <ph id=\"ph2\">`null`</ph> if there is no item at that location.","pos":[0,273],"source":"This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns the item at the specified location only, or `null` if there is no item at that location."},{"content":"The <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName&gt;</ph> method returns <ph id=\"ph2\">`null`</ph>, for example, when the mouse pointer is located between two items.","pos":[274,441],"source":" The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns `null`, for example, when the mouse pointer is located between two items."},{"content":"For this reason, you should always use the <ph id=\"ph1\">&lt;xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A&gt;</ph> method when using a drag-and-drop operation to position items.","pos":[442,613],"source":" For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items."}]}],"pos":[21844,22924],"yaml":true,"extradata":"MT"},{"content":"A <xref href=\"System.Drawing.Point\"></xref> representing the location from which to find the nearest item.","nodes":[{"pos":[0,106],"content":"A <ph id=\"ph1\">&lt;xref href=\"System.Drawing.Point\"&gt;&lt;/xref&gt;</ph> representing the location from which to find the nearest item.","source":"A <xref href=\"System.Drawing.Point\"></xref> representing the location from which to find the nearest item."}],"pos":[24341,24448],"yaml":true},{"content":"The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.","nodes":[{"pos":[0,115],"content":"The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.","nodes":[{"content":"The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.","pos":[0,115]}]}],"pos":[24504,24620],"yaml":true}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.Windows.Forms.ListViewInsertionMark\n  commentId: T:System.Windows.Forms.ListViewInsertionMark\n  id: ListViewInsertionMark\n  children:\n  - System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem\n  - System.Windows.Forms.ListViewInsertionMark.Bounds\n  - System.Windows.Forms.ListViewInsertionMark.Color\n  - System.Windows.Forms.ListViewInsertionMark.Index\n  - System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)\n  langs:\n  - csharp\n  name: ListViewInsertionMark\n  nameWithType: ListViewInsertionMark\n  fullName: System.Windows.Forms.ListViewInsertionMark\n  type: Class\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Used to indicate the expected drop location when an item is dragged to a new position in a <xref href=\"System.Windows.Forms.ListView\"></xref> control. This functionality is available only on Windows XP and later.\n  remarks: \"You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.  \\n  \\n This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=fullName> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically. To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.SortOrder?displayProperty=fullName> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=fullName> property must be set to <xref:System.Windows.Forms.View?displayProperty=fullName>, <xref:System.Windows.Forms.View?displayProperty=fullName>, or <xref:System.Windows.Forms.View?displayProperty=fullName>. Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.  \\n  \\n The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event to update the position of the insertion mark as an item is dragged. It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event to insert a dragged item at the correct location.  \\n  \\n To update the position of the insertion mark, follow these steps:  \\n  \\n1.  In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=fullName> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.  \\n  \\n2.  Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.  \\n  \\n3.  Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.  \\n  \\n4.  If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.  \\n  \\n5.  Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method. The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value. If an item is dragged over itself, the index is -1 and the insertion mark is hidden.  \\n  \\n To insert the dragged item at the correct location, follow these steps:  \\n  \\n1.  In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=fullName> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=fullName> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark. Store this value to be used later as the insertion index.  \\n  \\n2.  If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value.  \\n  \\n3.  Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=fullName> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection at the stored insertion index.  \\n  \\n4.  Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=fullName> method to remove the original copy of the dragged item.  \\n  \\n You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection are not altered before the insertion.  \\n  \\n To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=fullName> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value. For more information, see the Example section.  \\n  \\n You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property. If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.  \\n  \\n> [!NOTE]\\n>  The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=fullName> method. On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear. As a result, any code that depends on the insertion mark feature may not work correctly. You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable. For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.  \\n>   \\n>  The insertion mark feature is provided by the same library that provides the operating system themes feature. To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=fullName> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=fullName> value.\"\n  example:\n  - \"The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events. The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> event. In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.  \\n  \\n [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]\\n [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]\\n [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]\"\n  syntax:\n    content: public sealed class ListViewInsertionMark\n  inheritance:\n  - System.Object\n  implements: []\n  inheritedMembers:\n  - System.Object.Equals(System.Object)\n  - System.Object.Equals(System.Object,System.Object)\n  - System.Object.GetHashCode\n  - System.Object.GetType\n  - System.Object.MemberwiseClone\n  - System.Object.ReferenceEquals(System.Object,System.Object)\n  - System.Object.ToString\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\n- uid: System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem\n  commentId: P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem\n  id: AppearsAfterItem\n  parent: System.Windows.Forms.ListViewInsertionMark\n  langs:\n  - csharp\n  name: AppearsAfterItem\n  nameWithType: ListViewInsertionMark.AppearsAfterItem\n  fullName: ListViewInsertionMark.AppearsAfterItem\n  type: Property\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property.\n  remarks: \"The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.  \\n  \\n To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:  \\n  \\n1.  Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.  \\n  \\n2.  Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=fullName> method to retrieve the bounding rectangle of the item.  \\n  \\n3.  If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.  \\n  \\n For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.\"\n  example:\n  - \"The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events. The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> event. In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.  \\n  \\n For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.  \\n  \\n [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]\\n [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]\\n [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]\"\n  syntax:\n    content: public bool AppearsAfterItem { get; set; }\n    return:\n      type: System.Boolean\n      description: '`true` if the insertion mark appears to the right of the item with the index specified by the <xref href=\"System.Windows.Forms.ListViewInsertionMark.Index\"></xref> property; otherwise, `false`. The default is `false`.'\n  overload: System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem*\n  exceptions: []\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\n- uid: System.Windows.Forms.ListViewInsertionMark.Bounds\n  commentId: P:System.Windows.Forms.ListViewInsertionMark.Bounds\n  id: Bounds\n  parent: System.Windows.Forms.ListViewInsertionMark\n  langs:\n  - csharp\n  name: Bounds\n  nameWithType: ListViewInsertionMark.Bounds\n  fullName: ListViewInsertionMark.Bounds\n  type: Property\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Gets the bounding rectangle of the insertion mark.\n  remarks: The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.\n  syntax:\n    content: public System.Drawing.Rectangle Bounds { get; }\n    return:\n      type: System.Drawing.Rectangle\n      description: A <xref href=\"System.Drawing.Rectangle\"></xref> that represents the position and size of the insertion mark.\n  overload: System.Windows.Forms.ListViewInsertionMark.Bounds*\n  exceptions: []\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\n- uid: System.Windows.Forms.ListViewInsertionMark.Color\n  commentId: P:System.Windows.Forms.ListViewInsertionMark.Color\n  id: Color\n  parent: System.Windows.Forms.ListViewInsertionMark\n  langs:\n  - csharp\n  name: Color\n  nameWithType: ListViewInsertionMark.Color\n  fullName: ListViewInsertionMark.Color\n  type: Property\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Gets or sets the color of the insertion mark.\n  remarks: Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.\n  example:\n  - \"The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events. The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> event. In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.  \\n  \\n For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.  \\n  \\n [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]\\n [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]\\n [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]\"\n  syntax:\n    content: public System.Drawing.Color Color { get; set; }\n    return:\n      type: System.Drawing.Color\n      description: A <xref href=\"System.Drawing.Color\"></xref> value that represents the color of the insertion mark. The default value is the value of the <xref href=\"System.Windows.Forms.ListView.ForeColor\"></xref> property.\n  overload: System.Windows.Forms.ListViewInsertionMark.Color*\n  exceptions: []\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\n- uid: System.Windows.Forms.ListViewInsertionMark.Index\n  commentId: P:System.Windows.Forms.ListViewInsertionMark.Index\n  id: Index\n  parent: System.Windows.Forms.ListViewInsertionMark\n  langs:\n  - csharp\n  name: Index\n  nameWithType: ListViewInsertionMark.Index\n  fullName: ListViewInsertionMark.Index\n  type: Property\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Gets or sets the index of the item next to which the insertion mark appears.\n  remarks: \"The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item. The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=fullName> collection. To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.  \\n  \\n Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.\"\n  example:\n  - \"The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events. The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> event. In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.  \\n  \\n For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.  \\n  \\n [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]\\n [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]\\n [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]\"\n  syntax:\n    content: public int Index { get; set; }\n    return:\n      type: System.Int32\n      description: The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.\n  overload: System.Windows.Forms.ListViewInsertionMark.Index*\n  exceptions: []\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\n- uid: System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)\n  commentId: M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)\n  id: NearestIndex(System.Drawing.Point)\n  parent: System.Windows.Forms.ListViewInsertionMark\n  langs:\n  - csharp\n  name: NearestIndex(Point)\n  nameWithType: ListViewInsertionMark.NearestIndex(Point)\n  fullName: ListViewInsertionMark.NearestIndex(Point)\n  type: Method\n  assemblies:\n  - System.Windows.Forms\n  namespace: System.Windows.Forms\n  summary: Retrieves the index of the item closest to the specified point.\n  remarks: \"This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation. Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property. When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1. In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.  \\n  \\n This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns the item at the specified location only, or `null` if there is no item at that location. The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=fullName> method returns `null`, for example, when the mouse pointer is located between two items. For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.\"\n  example:\n  - \"The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events. The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=fullName> event. In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.  \\n  \\n For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.  \\n  \\n [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]\\n [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]\\n [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]\"\n  syntax:\n    content: public int NearestIndex (System.Drawing.Point pt);\n    parameters:\n    - id: pt\n      type: System.Drawing.Point\n      description: A <xref href=\"System.Drawing.Point\"></xref> representing the location from which to find the nearest item.\n    return:\n      type: System.Int32\n      description: The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.\n  overload: System.Windows.Forms.ListViewInsertionMark.NearestIndex*\n  exceptions: []\n  version:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n  ms.technology:\n  - dotnet-winforms\n  author: stevehoag\n  ms.author: shoag\n  manager: wpickett\nreferences:\n- uid: System.Object\n  parent: System\n  isExternal: false\n  name: Object\n  nameWithType: Object\n  fullName: System.Object\n- uid: System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: AppearsAfterItem\n  nameWithType: ListViewInsertionMark.AppearsAfterItem\n  fullName: ListViewInsertionMark.AppearsAfterItem\n- uid: System.Boolean\n  parent: System\n  isExternal: false\n  name: Boolean\n  nameWithType: Boolean\n  fullName: System.Boolean\n- uid: System.Windows.Forms.ListViewInsertionMark.Bounds\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Bounds\n  nameWithType: ListViewInsertionMark.Bounds\n  fullName: ListViewInsertionMark.Bounds\n- uid: System.Drawing.Rectangle\n  parent: System.Drawing\n  isExternal: false\n  name: Rectangle\n  nameWithType: Rectangle\n  fullName: System.Drawing.Rectangle\n- uid: System.Windows.Forms.ListViewInsertionMark.Color\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Color\n  nameWithType: ListViewInsertionMark.Color\n  fullName: ListViewInsertionMark.Color\n- uid: System.Drawing.Color\n  parent: System.Drawing\n  isExternal: false\n  name: Color\n  nameWithType: Color\n  fullName: System.Drawing.Color\n- uid: System.Windows.Forms.ListViewInsertionMark.Index\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Index\n  nameWithType: ListViewInsertionMark.Index\n  fullName: ListViewInsertionMark.Index\n- uid: System.Int32\n  parent: System\n  isExternal: false\n  name: Int32\n  nameWithType: Int32\n  fullName: System.Int32\n- uid: System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: NearestIndex(Point)\n  nameWithType: ListViewInsertionMark.NearestIndex(Point)\n  fullName: ListViewInsertionMark.NearestIndex(Point)\n- uid: System.Drawing.Point\n  parent: System.Drawing\n  isExternal: false\n  name: Point\n  nameWithType: Point\n  fullName: System.Drawing.Point\n- uid: System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem*\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: AppearsAfterItem\n  nameWithType: ListViewInsertionMark.AppearsAfterItem\n  fullName: ListViewInsertionMark.AppearsAfterItem\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n- uid: System.Windows.Forms.ListViewInsertionMark.Bounds*\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Bounds\n  nameWithType: ListViewInsertionMark.Bounds\n  fullName: ListViewInsertionMark.Bounds\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n- uid: System.Windows.Forms.ListViewInsertionMark.Color*\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Color\n  nameWithType: ListViewInsertionMark.Color\n  fullName: ListViewInsertionMark.Color\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n- uid: System.Windows.Forms.ListViewInsertionMark.Index*\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: Index\n  nameWithType: ListViewInsertionMark.Index\n  fullName: ListViewInsertionMark.Index\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n- uid: System.Windows.Forms.ListViewInsertionMark.NearestIndex*\n  parent: System.Windows.Forms.ListViewInsertionMark\n  isExternal: false\n  name: NearestIndex\n  nameWithType: ListViewInsertionMark.NearestIndex\n  fullName: ListViewInsertionMark.NearestIndex\n  monikers:\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Windows.Forms/ListViewInsertionMark.xml\n- uid: System.Object.Equals(System.Object)\n  parent: System.Object\n  isExternal: false\n  name: Equals(Object)\n  nameWithType: Object.Equals(Object)\n  fullName: Object.Equals(Object)\n- uid: System.Object.Equals(System.Object,System.Object)\n  parent: System.Object\n  isExternal: false\n  name: Equals(Object, Object)\n  nameWithType: Object.Equals(Object, Object)\n  fullName: Object.Equals(Object, Object)\n- uid: System.Object.GetHashCode\n  parent: System.Object\n  isExternal: false\n  name: GetHashCode()\n  nameWithType: Object.GetHashCode()\n  fullName: Object.GetHashCode()\n- uid: System.Object.GetType\n  parent: System.Object\n  isExternal: false\n  name: GetType()\n  nameWithType: Object.GetType()\n  fullName: Object.GetType()\n- uid: System.Object.MemberwiseClone\n  parent: System.Object\n  isExternal: false\n  name: MemberwiseClone()\n  nameWithType: Object.MemberwiseClone()\n  fullName: Object.MemberwiseClone()\n- uid: System.Object.ReferenceEquals(System.Object,System.Object)\n  parent: System.Object\n  isExternal: false\n  name: ReferenceEquals(Object, Object)\n  nameWithType: Object.ReferenceEquals(Object, Object)\n  fullName: Object.ReferenceEquals(Object, Object)\n- uid: System.Object.ToString\n  parent: System.Object\n  isExternal: false\n  name: ToString()\n  nameWithType: Object.ToString()\n  fullName: Object.ToString()\n"}
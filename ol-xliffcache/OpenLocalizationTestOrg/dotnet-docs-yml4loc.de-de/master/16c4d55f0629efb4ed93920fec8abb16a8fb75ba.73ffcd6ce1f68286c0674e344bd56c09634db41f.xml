{"nodes":[{"content":"Enables developers to provide a custom, managed implementation of the [IUnknown::QueryInterface(REFIID riid, void **ppvObject)](http://go.microsoft.com/fwlink/?LinkID=144867) method.","nodes":[{"pos":[0,182],"content":"Enables developers to provide a custom, managed implementation of the <bpt id=\"p1\">[</bpt>IUnknown::QueryInterface(REFIID riid, void **ppvObject)<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=144867)</ept> method.","source":"Enables developers to provide a custom, managed implementation of the [IUnknown::QueryInterface(REFIID riid, void **ppvObject)](http://go.microsoft.com/fwlink/?LinkID=144867) method."}],"pos":[607,790],"yaml":true},{"content":"This class permits advanced users to provide a customized managed implementation of the `QueryInterface` method.  \n  \n Managed and native applications can use the customized implementation to return a specific interface for a specified interface ID, except for IID_IUnknown. That is, when `QueryInterface` is called, it will ignore custom implementations if its `riid` parameter is set to IID_IUnknown. However, you may still return [IUnknown](http://go.microsoft.com/fwlink/?LinkId=148003) as the `ppvObject`.  \n  \n Developers can provide custom implementations for all interfaces (except for `IUnknown`) if they define and implement a valid corresponding interface.  \n  \n A valid user-defined interface has a v-table layout that matches the unmanaged COM interface exactly, and its <xref:System.Runtime.InteropServices.InterfaceTypeAttribute> is <xref:System.Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown>.","nodes":[{"pos":[0,112],"content":"This class permits advanced users to provide a customized managed implementation of the <ph id=\"ph1\">`QueryInterface`</ph> method.","source":"This class permits advanced users to provide a customized managed implementation of the `QueryInterface` method."},{"pos":[119,510],"content":"Managed and native applications can use the customized implementation to return a specific interface for a specified interface ID, except for IID_IUnknown. That is, when `QueryInterface` is called, it will ignore custom implementations if its `riid` parameter is set to IID_IUnknown. However, you may still return [IUnknown](http://go.microsoft.com/fwlink/?LinkId=148003) as the `ppvObject`.","nodes":[{"content":"Managed and native applications can use the customized implementation to return a specific interface for a specified interface ID, except for IID_IUnknown.","pos":[0,155]},{"content":"That is, when <ph id=\"ph1\">`QueryInterface`</ph> is called, it will ignore custom implementations if its <ph id=\"ph2\">`riid`</ph> parameter is set to IID_IUnknown.","pos":[156,283],"source":" That is, when `QueryInterface` is called, it will ignore custom implementations if its `riid` parameter is set to IID_IUnknown."},{"content":"However, you may still return <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=148003)</ept> as the <ph id=\"ph1\">`ppvObject`</ph>.","pos":[284,391],"source":" However, you may still return [IUnknown](http://go.microsoft.com/fwlink/?LinkId=148003) as the `ppvObject`."}]},{"pos":[517,667],"content":"Developers can provide custom implementations for all interfaces (except for <ph id=\"ph1\">`IUnknown`</ph>) if they define and implement a valid corresponding interface.","source":"Developers can provide custom implementations for all interfaces (except for `IUnknown`) if they define and implement a valid corresponding interface."},{"pos":[674,923],"content":"A valid user-defined interface has a v-table layout that matches the unmanaged COM interface exactly, and its <xref:System.Runtime.InteropServices.InterfaceTypeAttribute> is <xref:System.Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown>.","nodes":[{"content":"A valid user-defined interface has a v-table layout that matches the unmanaged COM interface exactly, and its <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.InterfaceTypeAttribute&gt;</ph> is <ph id=\"ph2\">&lt;xref:System.Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown&gt;</ph>.","pos":[0,249],"source":"A valid user-defined interface has a v-table layout that matches the unmanaged COM interface exactly, and its <xref:System.Runtime.InteropServices.InterfaceTypeAttribute> is <xref:System.Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown>."}]}],"pos":[801,1733],"yaml":true,"extradata":"MT"},{"content":"Returns an interface according to a specified interface ID.","nodes":[{"pos":[0,59],"content":"Returns an interface according to a specified interface ID.","nodes":[{"content":"Returns an interface according to a specified interface ID.","pos":[0,59]}]}],"pos":[3659,3719],"yaml":true},{"content":"An application can use managed code to specify its own implementation for custom interfaces and standard runtime interfaces.  \n  \n The <xref:System.Runtime.InteropServices.CustomQueryInterfaceResult> return value can be used to enable or disable customized implementations by showing or hiding specific interfaces during COM access.  \n  \n This method is invisible to COM.","nodes":[{"pos":[0,124],"content":"An application can use managed code to specify its own implementation for custom interfaces and standard runtime interfaces.","nodes":[{"content":"An application can use managed code to specify its own implementation for custom interfaces and standard runtime interfaces.","pos":[0,124]}]},{"pos":[131,332],"content":"The <xref:System.Runtime.InteropServices.CustomQueryInterfaceResult> return value can be used to enable or disable customized implementations by showing or hiding specific interfaces during COM access.","nodes":[{"content":"The <ph id=\"ph1\">&lt;xref:System.Runtime.InteropServices.CustomQueryInterfaceResult&gt;</ph> return value can be used to enable or disable customized implementations by showing or hiding specific interfaces during COM access.","pos":[0,201],"source":"The <xref:System.Runtime.InteropServices.CustomQueryInterfaceResult> return value can be used to enable or disable customized implementations by showing or hiding specific interfaces during COM access."}]},{"pos":[339,371],"content":"This method is invisible to COM.","nodes":[{"content":"This method is invisible to COM.","pos":[0,32]}]}],"pos":[3730,4108],"yaml":true,"extradata":"MT"},{"content":"The GUID of the requested interface.","nodes":[{"pos":[0,36],"content":"The GUID of the requested interface.","nodes":[{"content":"The GUID of the requested interface.","pos":[0,36]}]}],"pos":[4365,4402],"yaml":true},{"content":"A reference to the requested interface, when this method returns.","nodes":[{"pos":[0,65],"content":"A reference to the requested interface, when this method returns.","nodes":[{"content":"A reference to the requested interface, when this method returns.","pos":[0,65]}]}],"pos":[4461,4527],"yaml":true},{"content":"One of the enumeration values that indicates whether a custom implementation of [IUnknown::QueryInterface](http://go.microsoft.com/fwlink/?LinkID=144867) was used.","nodes":[{"pos":[0,163],"content":"One of the enumeration values that indicates whether a custom implementation of <bpt id=\"p1\">[</bpt>IUnknown::QueryInterface<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=144867)</ept> was used.","source":"One of the enumeration values that indicates whether a custom implementation of [IUnknown::QueryInterface](http://go.microsoft.com/fwlink/?LinkID=144867) was used."}],"pos":[4628,4792],"yaml":true}],"content":"### YamlMime:ManagedReference\nitems:\n- uid: System.Runtime.InteropServices.ICustomQueryInterface\n  commentId: T:System.Runtime.InteropServices.ICustomQueryInterface\n  id: ICustomQueryInterface\n  children:\n  - System.Runtime.InteropServices.ICustomQueryInterface.GetInterface(System.Guid@,System.IntPtr@)\n  langs:\n  - csharp\n  name: ICustomQueryInterface\n  nameWithType: ICustomQueryInterface\n  fullName: System.Runtime.InteropServices.ICustomQueryInterface\n  type: Interface\n  assemblies:\n  - System.Runtime.InteropServices\n  - mscorlib\n  - netstandard\n  namespace: System.Runtime.InteropServices\n  summary: Enables developers to provide a custom, managed implementation of the [IUnknown::QueryInterface(REFIID riid, void **ppvObject)](http://go.microsoft.com/fwlink/?LinkID=144867) method.\n  remarks: \"This class permits advanced users to provide a customized managed implementation of the `QueryInterface` method.  \\n  \\n Managed and native applications can use the customized implementation to return a specific interface for a specified interface ID, except for IID_IUnknown. That is, when `QueryInterface` is called, it will ignore custom implementations if its `riid` parameter is set to IID_IUnknown. However, you may still return [IUnknown](http://go.microsoft.com/fwlink/?LinkId=148003) as the `ppvObject`.  \\n  \\n Developers can provide custom implementations for all interfaces (except for `IUnknown`) if they define and implement a valid corresponding interface.  \\n  \\n A valid user-defined interface has a v-table layout that matches the unmanaged COM interface exactly, and its <xref:System.Runtime.InteropServices.InterfaceTypeAttribute> is <xref:System.Runtime.InteropServices.ComInterfaceType.InterfaceIsIUnknown>.\"\n  syntax:\n    content: >-\n      [System.Runtime.InteropServices.ComVisible(false)]\n\n      public interface ICustomQueryInterface\n  implements: []\n  attributes:\n  - type: System.Runtime.InteropServices.ComVisibleAttribute\n  version:\n  - netcore-1.0\n  - netcore-1.1\n  - netcore-2.0\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  - netstandard-1.1\n  - netstandard-1.2\n  - netstandard-1.3\n  - netstandard-1.4\n  - netstandard-1.5\n  - netstandard-1.6\n  - netstandard-2.0\n  - xamarinandroid-7.1\n  - xamarinios-10.8\n  - xamarinmac-3.0\n  monikers:\n  - netcore-1.0\n  - netcore-1.1\n  - netcore-2.0\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  - netstandard-1.1\n  - netstandard-1.2\n  - netstandard-1.3\n  - netstandard-1.4\n  - netstandard-1.5\n  - netstandard-1.6\n  - netstandard-2.0\n  - xamarinandroid-7.1\n  - xamarinios-10.8\n  - xamarinmac-3.0\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Runtime.InteropServices/ICustomQueryInterface.xml\n  ms.technology:\n  - dotnet-standard\n  author: rpetrusha\n  ms.author: ronpet\n  manager: wpickett\n- uid: System.Runtime.InteropServices.ICustomQueryInterface.GetInterface(System.Guid@,System.IntPtr@)\n  commentId: M:System.Runtime.InteropServices.ICustomQueryInterface.GetInterface(System.Guid@,System.IntPtr@)\n  id: GetInterface(System.Guid@,System.IntPtr@)\n  parent: System.Runtime.InteropServices.ICustomQueryInterface\n  langs:\n  - csharp\n  name: GetInterface(Guid, IntPtr)\n  nameWithType: ICustomQueryInterface.GetInterface(Guid, IntPtr)\n  fullName: ICustomQueryInterface.GetInterface(Guid, IntPtr)\n  type: Method\n  assemblies:\n  - System.Runtime.InteropServices\n  - mscorlib\n  - netstandard\n  namespace: System.Runtime.InteropServices\n  summary: Returns an interface according to a specified interface ID.\n  remarks: \"An application can use managed code to specify its own implementation for custom interfaces and standard runtime interfaces.  \\n  \\n The <xref:System.Runtime.InteropServices.CustomQueryInterfaceResult> return value can be used to enable or disable customized implementations by showing or hiding specific interfaces during COM access.  \\n  \\n This method is invisible to COM.\"\n  syntax:\n    content: >-\n      [System.Security.SecurityCritical]\n\n      public System.Runtime.InteropServices.CustomQueryInterfaceResult GetInterface (ref Guid iid, out IntPtr ppv);\n    parameters:\n    - id: iid\n      type: System.Guid\n      description: The GUID of the requested interface.\n    - id: ppv\n      type: System.IntPtr\n      description: A reference to the requested interface, when this method returns.\n    return:\n      type: System.Runtime.InteropServices.CustomQueryInterfaceResult\n      description: One of the enumeration values that indicates whether a custom implementation of [IUnknown::QueryInterface](http://go.microsoft.com/fwlink/?LinkID=144867) was used.\n  overload: System.Runtime.InteropServices.ICustomQueryInterface.GetInterface*\n  exceptions: []\n  attributes:\n  - type: System.Security.SecurityCriticalAttribute\n  version:\n  - netcore-1.0\n  - netcore-1.1\n  - netcore-2.0\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  - netstandard-1.1\n  - netstandard-1.2\n  - netstandard-1.3\n  - netstandard-1.4\n  - netstandard-1.5\n  - netstandard-1.6\n  - netstandard-2.0\n  - xamarinandroid-7.1\n  - xamarinios-10.8\n  - xamarinmac-3.0\n  monikers:\n  - netcore-1.0\n  - netcore-1.1\n  - netcore-2.0\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  - netstandard-1.1\n  - netstandard-1.2\n  - netstandard-1.3\n  - netstandard-1.4\n  - netstandard-1.5\n  - netstandard-1.6\n  - netstandard-2.0\n  - xamarinandroid-7.1\n  - xamarinios-10.8\n  - xamarinmac-3.0\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Runtime.InteropServices/ICustomQueryInterface.xml\n  ms.technology:\n  - dotnet-standard\n  author: rpetrusha\n  ms.author: ronpet\n  manager: wpickett\nreferences:\n- uid: System.Runtime.InteropServices.ICustomQueryInterface.GetInterface(System.Guid@,System.IntPtr@)\n  parent: System.Runtime.InteropServices.ICustomQueryInterface\n  isExternal: false\n  name: GetInterface(Guid, IntPtr)\n  nameWithType: ICustomQueryInterface.GetInterface(Guid, IntPtr)\n  fullName: ICustomQueryInterface.GetInterface(Guid, IntPtr)\n- uid: System.Runtime.InteropServices.CustomQueryInterfaceResult\n  parent: System.Runtime.InteropServices\n  isExternal: false\n  name: CustomQueryInterfaceResult\n  nameWithType: CustomQueryInterfaceResult\n  fullName: System.Runtime.InteropServices.CustomQueryInterfaceResult\n- uid: System.Guid\n  parent: System\n  isExternal: false\n  name: Guid\n  nameWithType: Guid\n  fullName: System.Guid\n- uid: System.IntPtr\n  parent: System\n  isExternal: false\n  name: IntPtr\n  nameWithType: IntPtr\n  fullName: System.IntPtr\n- uid: System.Runtime.InteropServices.ICustomQueryInterface.GetInterface*\n  parent: System.Runtime.InteropServices.ICustomQueryInterface\n  isExternal: false\n  name: GetInterface\n  nameWithType: ICustomQueryInterface.GetInterface\n  fullName: ICustomQueryInterface.GetInterface\n  monikers:\n  - netcore-1.0\n  - netcore-1.1\n  - netcore-2.0\n  - netframework-4.5.1\n  - netframework-4.5.2\n  - netframework-4.5\n  - netframework-4.6.1\n  - netframework-4.6.2\n  - netframework-4.6\n  - netframework-4.7\n  - netstandard-1.1\n  - netstandard-1.2\n  - netstandard-1.3\n  - netstandard-1.4\n  - netstandard-1.5\n  - netstandard-1.6\n  - netstandard-2.0\n  - xamarinandroid-7.1\n  - xamarinios-10.8\n  - xamarinmac-3.0\n  content_git_url: https://github.com/dotnet/docs/blob/master/xml/System.Runtime.InteropServices/ICustomQueryInterface.xml\n"}